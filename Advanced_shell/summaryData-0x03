#!/bin/bash

echo "Name,Height (m),Weight (kg)" > pokemon_report.csv

total_h=0
total_w=0
count=0

for file in pokemon_data/*.json
do
  name=$(jq -r '.name' "$file")
  height=$(jq -r '.height' "$file")
  weight=$(jq -r '.weight' "$file")

  h=$(awk "BEGIN { printf \"%.1f\", $height / 10 }")
  w=$(awk "BEGIN { printf \"%.1f\", $weight / 10 }")

  echo "$(echo $name | sed 's/.*/\u&/'),$h,$w" >> pokemon_report.csv

  total_h=$(awk "BEGIN { print $total_h + $h }")
  total_w=$(awk "BEGIN { print $total_w + $w }")
  count=$((count + 1))
done

avg_h=$(awk "BEGIN { printf \"%.2f\", $total_h / $count }")
avg_w=$(awk "BEGIN { printf \"%.2f\", $total_w / $count }")

echo ""
echo "CSV Report generated at: pokemon_report.csv"
echo ""
cat pokemon_report.csv
echo ""
echo "Average Height: ${avg_h} m"
echo "Average Weight: ${avg_w} kg"
